# ğŸš€ é’é¾™è™šæ‹Ÿç¯å¢ƒç®¡ç†å®Œæ•´è§£å†³æ–¹æ¡ˆ

## ğŸ“‹ ç›®å½•

- [1. æ–¹æ¡ˆæ¦‚è¿°](#1-æ–¹æ¡ˆæ¦‚è¿°)
- [2. é—®é¢˜åˆ†æ](#2-é—®é¢˜åˆ†æ)
- [3. è§£å†³æ–¹æ¡ˆæ¶æ„](#3-è§£å†³æ–¹æ¡ˆæ¶æ„)
- [4. æ ¸å¿ƒç»„ä»¶è¯¦è§£](#4-æ ¸å¿ƒç»„ä»¶è¯¦è§£)
- [5. å®æ–½æŒ‡å—](#5-å®æ–½æŒ‡å—)
- [6. æŠ€æœ¯åŸç†](#6-æŠ€æœ¯åŸç†)
- [7. ä½¿ç”¨æµç¨‹](#7-ä½¿ç”¨æµç¨‹)
- [8. æ•…éšœæ’é™¤](#8-æ•…éšœæ’é™¤)
- [9. æœ€ä½³å®è·µ](#9-æœ€ä½³å®è·µ)
- [10. æ€»ç»“](#10-æ€»ç»“)

---

## 1. æ–¹æ¡ˆæ¦‚è¿°

### 1.1 èƒŒæ™¯

é’é¾™é¢æ¿æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å®šæ—¶ä»»åŠ¡ç®¡ç†å¹³å°ï¼Œä½†åœ¨å¤„ç† Python/Node.js é¡¹ç›®çš„ä¾èµ–ç®¡ç†æ—¶å­˜åœ¨æŒ‘æˆ˜ï¼š

- **ä¾èµ–å†²çª**ï¼šä¸åŒé¡¹ç›®çš„ä¾èµ–ç‰ˆæœ¬å¯èƒ½å†²çª
- **ç¯å¢ƒæ±¡æŸ“**ï¼šå…¨å±€å®‰è£…çš„åŒ…ä¼šå½±å“æ‰€æœ‰é¡¹ç›®
- **ç»´æŠ¤å›°éš¾**ï¼šæ‰‹åŠ¨ç®¡ç†ä¾èµ–ç¹çä¸”å®¹æ˜“å‡ºé”™
- **éš”ç¦»éœ€æ±‚**ï¼šé¡¹ç›®éœ€è¦ç‹¬ç«‹çš„è¿è¡Œç¯å¢ƒ

### 1.2 è§£å†³æ–¹æ¡ˆç›®æ ‡

æœ¬æ–¹æ¡ˆæ—¨åœ¨ä¸ºé’é¾™é¢æ¿æä¾›**å®Œå…¨è‡ªåŠ¨åŒ–çš„è™šæ‹Ÿç¯å¢ƒç®¡ç†**ï¼Œå®ç°ï¼š

- âœ… **é›¶é…ç½®**ï¼šæ— éœ€æ‰‹åŠ¨è®¾ç½®ï¼Œè‡ªåŠ¨æ£€æµ‹å’Œåˆ›å»º
- âœ… **é›¶ç»´æŠ¤**ï¼šè®¢é˜…æ›´æ–°è‡ªåŠ¨ç»´æŠ¤è™šæ‹Ÿç¯å¢ƒ
- âœ… **å®Œå…¨éš”ç¦»**ï¼šæ¯ä¸ªé¡¹ç›®ç‹¬ç«‹çš„ä¾èµ–ç¯å¢ƒ
- âœ… **é€æ˜è¿è¡Œ**ï¼šä¸å½±å“é’é¾™åŸæœ‰åŠŸèƒ½
- âœ… **æ™ºèƒ½æ¿€æ´»**ï¼šè„šæœ¬æ‰§è¡Œæ—¶è‡ªåŠ¨ä½¿ç”¨å¯¹åº”è™šæ‹Ÿç¯å¢ƒ

### 1.3 æ–¹æ¡ˆç‰¹è‰²

- ğŸ¯ **åŒé‡ä¿éšœ**ï¼šåˆ›å»º + æ¿€æ´»ä¸¤ä¸ªç»´åº¦çš„è‡ªåŠ¨åŒ–
- ğŸ”§ **éä¾µå…¥å¼**ï¼šä¸ç ´åé’é¾™æ ¸å¿ƒåŠŸèƒ½
- ğŸš€ **é«˜åº¦è‡ªåŠ¨åŒ–**ï¼šä»åˆ›å»ºåˆ°ä½¿ç”¨å…¨ç¨‹è‡ªåŠ¨
- ğŸ›¡ï¸ **å®‰å…¨å¯é **ï¼šå®Œæ•´çš„å¤‡ä»½å’Œæ¢å¤æœºåˆ¶
- ğŸ“Š **è¯¦ç»†ç›‘æ§**ï¼šå®Œæ•´çš„æ—¥å¿—å’ŒçŠ¶æ€è¿½è¸ª

---

## 2. é—®é¢˜åˆ†æ

### 2.1 é’é¾™æ‰§è¡Œæœºåˆ¶åˆ†æ

#### 2.1.1 è„šæœ¬æ‰§è¡Œæµç¨‹

```mermaid
graph TD
    A[é’é¾™è°ƒåº¦å™¨] --> B[æ‰§è¡Œ task_before.sh]
    B --> C[åŠ è½½ç¯å¢ƒå˜é‡]
    C --> D[è°ƒç”¨ sitecustomize.py]
    D --> E[æ‰§è¡Œ Python è„šæœ¬]
    E --> F[æ‰§è¡Œ task_after.sh]
```

#### 2.1.2 å…³é”®å‘ç°

1. **sitecustomize.py**ï¼šPython å¯åŠ¨æ—¶è‡ªåŠ¨æ‰§è¡Œçš„è„šæœ¬
2. **task_before.sh**ï¼šä»»åŠ¡æ‰§è¡Œå‰çš„é’©å­è„šæœ¬
3. **ç¯å¢ƒå˜é‡åŠ è½½æ—¶åº**ï¼šé’é¾™æœ‰ç‰¹å®šçš„ç¯å¢ƒå˜é‡åŠ è½½é¡ºåº
4. **è®¢é˜…æ›´æ–°é’©å­**ï¼š`sub_after` æœºåˆ¶å¯ä»¥åœ¨è®¢é˜…æ›´æ–°åæ‰§è¡Œè‡ªå®šä¹‰é€»è¾‘

### 2.2 æ ¸å¿ƒæŒ‘æˆ˜

#### 2.2.1 æ—¶åºé—®é¢˜
- è™šæ‹Ÿç¯å¢ƒæ¿€æ´»å¿…é¡»åœ¨ç¯å¢ƒå˜é‡åŠ è½½**ä¹‹å**
- Python æ¨¡å—å¯¼å…¥å‘ç”Ÿåœ¨è„šæœ¬æ‰§è¡Œçš„**æœ€å¼€å§‹**

#### 2.2.2 è·¯å¾„æ£€æµ‹é—®é¢˜
- é’é¾™çš„å·¥ä½œç›®å½•å’Œè„šæœ¬è·¯å¾„ä¼ é€’æœºåˆ¶å¤æ‚
- éœ€è¦æ™ºèƒ½æ£€æµ‹é¡¹ç›®åç§°å’Œè™šæ‹Ÿç¯å¢ƒä½ç½®

#### 2.2.3 è‡ªåŠ¨åŒ–ç¨‹åº¦
- ç”¨æˆ·å¸Œæœ›é›¶é…ç½®ã€é›¶ç»´æŠ¤
- è®¢é˜…æ›´æ–°ä¼šè¦†ç›–æ‰‹åŠ¨ä¿®æ”¹

---

## 3. è§£å†³æ–¹æ¡ˆæ¶æ„

### 3.1 æ•´ä½“æ¶æ„

```mermaid
graph TB
    subgraph "è®¢é˜…ç®¡ç†å±‚"
        A[è®¢é˜…æ›´æ–°] --> B[update.sh Shellè„šæœ¬]
        B --> C[qinglong_venv_manager.py]
        C --> D[åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ]
    end
    
    subgraph "è¿è¡Œæ—¶å±‚"
        E[Python è„šæœ¬å¯åŠ¨] --> F[sitecustomize.py]
        F --> G[è‡ªåŠ¨æ£€æµ‹é¡¹ç›®]
        G --> H[æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ]
        H --> I[æ‰§è¡Œè„šæœ¬]
    end
    
    subgraph "ç®¡ç†å·¥å…·å±‚"
        J[qinglong_venv_manager.py] --> K[æ‰‹åŠ¨ç®¡ç†]
        L[shell_patch_installer.sh] --> M[Shellè¡¥ä¸ç®¡ç†]
        N[qinglong_venv_installer.sh] --> O[ç³»ç»Ÿå®‰è£…ç®¡ç†]
    end
    
    D --> H
```

### 3.2 æ ¸å¿ƒç»„ä»¶

| ç»„ä»¶ | åŠŸèƒ½ | è§¦å‘æ—¶æœº | ä½œç”¨èŒƒå›´ |
|------|------|----------|----------|
| **sitecustomize.py è¡¥ä¸** | è‡ªåŠ¨æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ | Python è„šæœ¬å¯åŠ¨æ—¶ | æ‰€æœ‰ Python è„šæœ¬ |
| **update.sh Shell è¡¥ä¸** | è‡ªåŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ | è®¢é˜…æ›´æ–°å®Œæˆå | æ‰€æœ‰è®¢é˜…é¡¹ç›® |
| **qinglong_venv_manager.py** | è™šæ‹Ÿç¯å¢ƒåˆ›å»ºå’Œç®¡ç† | Shellè¡¥ä¸è°ƒç”¨æˆ–æ‰‹åŠ¨è°ƒç”¨ | å•ä¸ªæˆ–å¤šä¸ªé¡¹ç›® |
| **shell_patch_installer.sh** | Shellè¡¥ä¸å®‰è£…å™¨ | ç”¨æˆ·ä¸»åŠ¨è°ƒç”¨ | ç³»ç»Ÿçº§å®‰è£… |

### 3.3 æ•°æ®æµ

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant Q as é’é¾™é¢æ¿
    participant S as Shellè„šæœ¬(update.sh)
    participant V as è™šæ‹Ÿç¯å¢ƒç®¡ç†å™¨
    participant P as Pythonè¿è¡Œæ—¶
    
    U->>Q: æ‰§è¡Œ ql repo å‘½ä»¤
    Q->>S: è°ƒç”¨ update.sh
    S->>S: æ‹‰å–ä»£ç æˆåŠŸ
    S->>V: è°ƒç”¨ qinglong_venv_manager.py
    V->>V: æ£€æµ‹é¡¹ç›®ç±»å‹
    V->>V: åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
    V->>V: å®‰è£…ä¾èµ–
    
    Note over U,P: è„šæœ¬æ‰§è¡Œé˜¶æ®µ
    
    U->>Q: æ‰§è¡Œå®šæ—¶ä»»åŠ¡
    Q->>P: å¯åŠ¨ Python è„šæœ¬
    P->>P: åŠ è½½ sitecustomize.py
    P->>P: æ£€æµ‹é¡¹ç›®è™šæ‹Ÿç¯å¢ƒ
    P->>P: æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
    P->>P: æ‰§è¡Œè„šæœ¬é€»è¾‘
```

---

## 4. æ ¸å¿ƒç»„ä»¶è¯¦è§£

### 4.1 sitecustomize.py è¡¥ä¸

#### 4.1.1 åŠŸèƒ½æè¿°
ä¿®æ”¹é’é¾™çš„ Python å¯åŠ¨è„šæœ¬ï¼Œåœ¨ç¯å¢ƒå˜é‡åŠ è½½å®Œæˆåè‡ªåŠ¨æ£€æµ‹å¹¶æ¿€æ´»é¡¹ç›®å¯¹åº”çš„è™šæ‹Ÿç¯å¢ƒã€‚

#### 4.1.2 æ ¸å¿ƒé€»è¾‘
```python
def auto_activate_venv_after_env_loaded():
    """åœ¨ç¯å¢ƒå˜é‡åŠ è½½å®Œæˆåè‡ªåŠ¨æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ"""
    
    # 1. è·å–å½“å‰å·¥ä½œç›®å½•å’Œè„šæœ¬è·¯å¾„
    current_dir = os.getcwd()
    script_file = sys.argv[0] if sys.argv else ""
    
    # 2. å¤šç§æ–¹å¼æ£€æµ‹é¡¹ç›®åç§°
    project_name = detect_project_name(current_dir, script_file)
    
    # 3. æŸ¥æ‰¾å¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
    if project_name:
        venv_dir = f"/ql/data/scripts/{project_name}/.venv"
        if os.path.isdir(venv_dir):
            activate_virtual_environment(venv_dir, project_name)
```

#### 4.1.3 é¡¹ç›®æ£€æµ‹ç­–ç•¥
1. **å·¥ä½œç›®å½•æ£€æµ‹**ï¼šä» `/ql/data/scripts/é¡¹ç›®å/` æå–é¡¹ç›®å
2. **è„šæœ¬è·¯å¾„æ£€æµ‹**ï¼šä»è„šæœ¬å®Œæ•´è·¯å¾„æå–é¡¹ç›®å
3. **å‘ä¸ŠæŸ¥æ‰¾**ï¼šé€’å½’æŸ¥æ‰¾åŒ…å« `.venv` çš„ç›®å½•

#### 4.1.4 æ¿€æ´»æœºåˆ¶
```python
# å°†è™šæ‹Ÿç¯å¢ƒçš„ site-packages æ·»åŠ åˆ° sys.path
site_packages = f"{venv_dir}/lib/python3.11/site-packages"
if site_packages not in sys.path:
    sys.path.insert(1, site_packages)
    
# è®¾ç½®ç¯å¢ƒå˜é‡
os.environ['VIRTUAL_ENV'] = venv_dir
os.environ['VIRTUAL_ENV_PROJECT'] = project_name
```

### 4.2 Shell è„šæœ¬è¡¥ä¸

#### 4.2.1 åŠŸèƒ½æè¿°
ä¿®æ”¹é’é¾™çš„ `update.sh` è„šæœ¬ï¼Œåœ¨è®¢é˜…æ›´æ–°æˆåŠŸåè‡ªåŠ¨è°ƒç”¨è™šæ‹Ÿç¯å¢ƒåˆ›å»ºè„šæœ¬ã€‚

#### 4.2.2 æ ¸å¿ƒä¿®æ”¹ç‚¹
åœ¨ `update_repo` å‡½æ•°çš„æˆåŠŸåˆ†æ”¯ä¸­æ·»åŠ ï¼š

```bash
# ğŸ¯ è‡ªåŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ (auto_create_venv_in_shell)
if [[ -f "/ql/scripts/qinglong_venv_manager.py" ]]; then
  echo -e "\n## è‡ªåŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ...\n"
  python3 /ql/scripts/qinglong_venv_manager.py create "${uniq_path}" 2>&1 || echo "è™šæ‹Ÿç¯å¢ƒåˆ›å»ºå¤±è´¥ï¼Œä½†ä¸å½±å“è®¢é˜…æ‰§è¡Œ"
  echo -e "è™šæ‹Ÿç¯å¢ƒè‡ªåŠ¨åˆ›å»ºå®Œæˆ\n"
fi
```

#### 4.2.3 å®‰è£…æ–¹å¼
```bash
# ä½¿ç”¨å®Œæ•´ç³»ç»Ÿå®‰è£…å™¨ï¼ˆåŒ…å« Shell è¡¥ä¸ï¼‰
bash qinglong_venv_installer.sh install

# æ£€æŸ¥å®‰è£…çŠ¶æ€
bash qinglong_venv_installer.sh status

# å¸è½½è¡¥ä¸
bash qinglong_venv_installer.sh uninstall
```

### 4.3 è™šæ‹Ÿç¯å¢ƒç®¡ç†å™¨

#### 4.3.1 åŠŸèƒ½æè¿°
`qinglong_venv_manager.py` æ˜¯æ ¸å¿ƒçš„è™šæ‹Ÿç¯å¢ƒç®¡ç†å·¥å…·ï¼Œè´Ÿè´£æ£€æµ‹é¡¹ç›®ç±»å‹å¹¶åˆ›å»ºã€ç®¡ç†è™šæ‹Ÿç¯å¢ƒã€‚

#### 4.3.2 é¡¹ç›®ç±»å‹æ£€æµ‹
```python
def detect_project_type(project_dir):
    """æ£€æµ‹é¡¹ç›®ç±»å‹å’Œä¾èµ–æ–‡ä»¶"""
    
    # Python é¡¹ç›®æ£€æµ‹
    python_files = [
        "requirements.txt", "pyproject.toml", 
        "setup.py", "Pipfile"
    ]
    
    # Node.js é¡¹ç›®æ£€æµ‹  
    nodejs_files = [
        "package.json", "yarn.lock", "pnpm-lock.yaml"
    ]
    
    return {
        "has_python": any(Path(project_dir, f).exists() for f in python_files),
        "has_nodejs": any(Path(project_dir, f).exists() for f in nodejs_files)
    }
```

#### 4.3.3 è™šæ‹Ÿç¯å¢ƒåˆ›å»ºæµç¨‹

**Python è™šæ‹Ÿç¯å¢ƒï¼š**
```python
def create_python_venv(project_name, scripts_dir, repo_dir):
    # 1. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
    subprocess.run([sys.executable, "-m", "venv", venv_dir])
    
    # 2. æŸ¥æ‰¾ä¾èµ–æ–‡ä»¶
    requirements_files = [
        f"{scripts_dir}/requirements.txt",
        f"{repo_dir}/requirements.txt"
    ]
    
    # 3. å®‰è£…ä¾èµ–
    for req_file in requirements_files:
        if os.path.exists(req_file):
            subprocess.run([
                f"{venv_dir}/bin/pip", "install", "-r", req_file,
                "-i", "https://pypi.tuna.tsinghua.edu.cn/simple"
            ])
            break
```

**Node.js ç¯å¢ƒï¼š**
```python
def create_nodejs_venv(project_name, scripts_dir, repo_dir):
    # 1. æŸ¥æ‰¾ package.json
    # 2. å¤åˆ¶åˆ° scripts ç›®å½•
    # 3. æ‰§è¡Œ npm install
```

### 4.4 ç®¡ç†å·¥å…·

#### 4.4.1 è¡¥ä¸ç®¡ç†è„šæœ¬
- `qinglong_venv_installer.sh`ï¼šå®Œæ•´ç³»ç»Ÿå®‰è£…å™¨ï¼ŒåŒ…å« sitecustomize.py è¡¥ä¸å’Œ Shell è„šæœ¬è¡¥ä¸

#### 4.4.2 è™šæ‹Ÿç¯å¢ƒç®¡ç†å·¥å…·
- `qinglong_venv_manager.py`ï¼šå®Œæ•´çš„è™šæ‹Ÿç¯å¢ƒç®¡ç†å·¥å…·ï¼Œæ”¯æŒåˆ›å»ºã€åˆ é™¤ã€åˆ—å‡ºã€æŸ¥çœ‹è¯¦æƒ…

---

## 5. å®æ–½æŒ‡å—

### 5.1 ç¯å¢ƒè¦æ±‚

- **é’é¾™é¢æ¿**ï¼šæ”¯æŒçš„é’é¾™ç‰ˆæœ¬
- **Python**ï¼š3.8+ 
- **Node.js**ï¼š14+ (å¦‚éœ€ Node.js é¡¹ç›®æ”¯æŒ)
- **ç³»ç»Ÿæƒé™**ï¼šroot æˆ– sudo æƒé™

### 5.2 å®‰è£…æ­¥éª¤

#### å®Œæ•´ç³»ç»Ÿå®‰è£… (æ¨è)

```bash
# 1. ä¸‹è½½å®Œæ•´å®‰è£…å™¨
wget -O qinglong_venv_installer.sh https://raw.githubusercontent.com/.../qinglong_venv_installer.sh

# 2. å®‰è£…å®Œæ•´ç³»ç»Ÿ (åŒ…å« sitecustomize.py è¡¥ä¸å’Œ Shell è„šæœ¬è¡¥ä¸)
bash qinglong_venv_installer.sh install

# 3. éªŒè¯å®‰è£…
bash qinglong_venv_installer.sh status
```

#### éªŒè¯å®‰è£…

```bash
# 1. æ£€æŸ¥è¡¥ä¸çŠ¶æ€
bash qinglong_venv_installer.sh status

# 2. æµ‹è¯•è™šæ‹Ÿç¯å¢ƒç®¡ç†
python3 /ql/scripts/qinglong_venv_manager.py list

# 3. æµ‹è¯•è®¢é˜…è‡ªåŠ¨åˆ›å»ºåŠŸèƒ½
ql repo "https://github.com/user/project.git" "" "" "requirements.txt" "main" "py"
```

### 5.3 é…ç½®è¯´æ˜

#### 5.3.1 æ— éœ€é…ç½®
æœ¬æ–¹æ¡ˆè®¾è®¡ä¸º**é›¶é…ç½®**ï¼Œå®‰è£…åå³å¯è‡ªåŠ¨å·¥ä½œã€‚

#### 5.3.2 å¯é€‰é…ç½®
å¦‚éœ€è‡ªå®šä¹‰è¡Œä¸ºï¼Œå¯ä»¥ä¿®æ”¹ä»¥ä¸‹æ–‡ä»¶ï¼š
- `/ql/scripts/qinglong_venv_manager.py`ï¼šè™šæ‹Ÿç¯å¢ƒç®¡ç†é€»è¾‘
- `/ql/shell/update.sh`ï¼šShell è„šæœ¬è¡¥ä¸ä½ç½®

#### 5.3.3 æ›¿ä»£æ–¹æ¡ˆï¼šWeb ç•Œé¢é…ç½®
å¦‚æœä¸æƒ³ä¿®æ”¹ Shell è„šæœ¬ï¼Œå¯ä»¥åœ¨é’é¾™ Web ç•Œé¢çš„è®¢é˜…é…ç½®ä¸­ï¼Œåœ¨ **"è®¢é˜…åæ‰§è¡Œ"** å­—æ®µæ·»åŠ ï¼š
```bash
python3 /ql/scripts/qinglong_venv_manager.py create $(basename $(pwd))
```

---

## 6. æŠ€æœ¯åŸç†

### 6.1 è™šæ‹Ÿç¯å¢ƒæ¿€æ´»åŸç†

#### 6.1.1 Python æ¨¡å—æŸ¥æ‰¾æœºåˆ¶
Python é€šè¿‡ `sys.path` åˆ—è¡¨æŸ¥æ‰¾æ¨¡å—ï¼š
```python
# sys.path çš„å…¸å‹å†…å®¹
[
    '',                    # å½“å‰ç›®å½•
    '/usr/lib/python3.11', # æ ‡å‡†åº“
    '/usr/lib/python3.11/site-packages', # å…¨å±€åŒ…
    # ... å…¶ä»–è·¯å¾„
]
```

#### 6.1.2 è™šæ‹Ÿç¯å¢ƒæ¿€æ´»æœºåˆ¶
```python
# å°†è™šæ‹Ÿç¯å¢ƒçš„ site-packages æ’å…¥åˆ° sys.path å‰é¢
venv_site_packages = "/path/to/.venv/lib/python3.11/site-packages"
sys.path.insert(1, venv_site_packages)

# è¿™æ · Python ä¼šä¼˜å…ˆä»è™šæ‹Ÿç¯å¢ƒä¸­æŸ¥æ‰¾æ¨¡å—
```

#### 6.1.3 sitecustomize.py æœºåˆ¶
- Python å¯åŠ¨æ—¶è‡ªåŠ¨å¯¼å…¥ `sitecustomize` æ¨¡å—
- é’é¾™å°†æ­¤æ–‡ä»¶æ”¾åœ¨ `/ql/shell/preload/` ç›®å½•
- é€šè¿‡ä¿®æ”¹æ­¤æ–‡ä»¶å®ç°å…¨å±€çš„è™šæ‹Ÿç¯å¢ƒæ¿€æ´»

### 6.2 é¡¹ç›®æ£€æµ‹ç®—æ³•

#### 6.2.1 å¤šç­–ç•¥æ£€æµ‹
```python
def detect_project_name(current_dir, script_file):
    # ç­–ç•¥1: ä»å·¥ä½œç›®å½•æ£€æµ‹
    if '/ql/data/scripts/' in current_dir:
        return extract_from_path(current_dir)
    
    # ç­–ç•¥2: ä»è„šæœ¬è·¯å¾„æ£€æµ‹  
    if '/ql/data/scripts/' in script_file:
        return extract_from_path(script_file)
    
    # ç­–ç•¥3: å‘ä¸ŠæŸ¥æ‰¾ .venv ç›®å½•
    return find_venv_parent(current_dir)
```

#### 6.2.2 è·¯å¾„è§£æé€»è¾‘
```python
def extract_project_name(path):
    """ä»è·¯å¾„ä¸­æå–é¡¹ç›®åç§°"""
    scripts_path = '/ql/data/scripts/'
    if path.startswith(scripts_path):
        relative_path = path[len(scripts_path):]
        return relative_path.split('/')[0]
    return None
```

### 6.3 Shell è„šæœ¬é’©å­æœºåˆ¶

#### 6.3.1 é’é¾™è®¢é˜…æ‰§è¡Œæµç¨‹
```bash
# ql repo å‘½ä»¤æ‰§è¡Œæµç¨‹
ql repo <url> <params...>
  â†“
update.sh è„šæœ¬
  â†“
update_repo() å‡½æ•°
  â†“
git_clone_scripts() # æ‹‰å–ä»£ç 
  â†“
diff_scripts() # å¤„ç†è„šæœ¬
  â†“
ğŸ¯ Shell è¡¥ä¸é’©å­ # æˆ‘ä»¬çš„è™šæ‹Ÿç¯å¢ƒåˆ›å»ºé€»è¾‘
```

#### 6.3.2 é’©å­æ³¨å…¥ç‚¹
åœ¨ `update_repo` å‡½æ•°çš„æˆåŠŸåˆ†æ”¯ä¸­æ³¨å…¥ï¼š
```bash
if [[ $exit_status -eq 0 ]]; then
  echo -e "æ‹‰å– ${uniq_path} æˆåŠŸ...\n"
  diff_scripts "$repo_path" "$author" "$path" "$blackword" "$dependence" "$extensions" "$autoAddCron" "$autoDelCron"
  
  # ğŸ¯ æ–°å¢ï¼šè‡ªåŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
  if [[ -f "/ql/scripts/qinglong_venv_manager.py" ]]; then
    python3 /ql/scripts/qinglong_venv_manager.py create "${uniq_path}"
  fi
fi
```

---

## 7. ä½¿ç”¨æµç¨‹

### 7.1 è‡ªåŠ¨åŒ–æµç¨‹

#### 7.1.1 è®¢é˜…æ·»åŠ /æ›´æ–°æµç¨‹
```mermaid
graph TD
    A[ç”¨æˆ·æ·»åŠ /æ›´æ–°è®¢é˜…] --> B[é’é¾™æ‹‰å–ä»£ç ]
    B --> C[ä»£ç æ‹‰å–æˆåŠŸ]
    C --> D[è§¦å‘ onEnd å›è°ƒ]
    D --> E[è°ƒç”¨ auto_create_venv.py]
    E --> F[æ£€æµ‹é¡¹ç›®ç±»å‹]
    F --> G{æ˜¯å¦ä¸º Python/Node.js é¡¹ç›®?}
    G -->|æ˜¯| H[åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ]
    G -->|å¦| I[è·³è¿‡åˆ›å»º]
    H --> J[å®‰è£…é¡¹ç›®ä¾èµ–]
    J --> K[è™šæ‹Ÿç¯å¢ƒåˆ›å»ºå®Œæˆ]
    I --> K
```

#### 7.1.2 è„šæœ¬æ‰§è¡Œæµç¨‹
```mermaid
graph TD
    A[é’é¾™æ‰§è¡Œå®šæ—¶ä»»åŠ¡] --> B[å¯åŠ¨ Python è„šæœ¬]
    B --> C[åŠ è½½ sitecustomize.py]
    C --> D[æ£€æµ‹å½“å‰é¡¹ç›®]
    D --> E{æ˜¯å¦æœ‰è™šæ‹Ÿç¯å¢ƒ?}
    E -->|æ˜¯| F[æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ]
    E -->|å¦| G[ä½¿ç”¨å…¨å±€ç¯å¢ƒ]
    F --> H[æ‰§è¡Œè„šæœ¬é€»è¾‘]
    G --> H
    H --> I[è„šæœ¬æ‰§è¡Œå®Œæˆ]
```

#### 7.1.3 å®é™…æ‰§è¡Œç¤ºä¾‹
```bash
# æ‰§è¡Œ ql repo å‘½ä»¤
ql repo "https://github.com/user/project.git" "" "" "requirements.txt" "main" "py"

# è¾“å‡ºæ—¥å¿—ç¤ºä¾‹ï¼š
æ‹‰å– project_main æˆåŠŸ...

## è‡ªåŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ...

[INFO] ä¸ºé¡¹ç›® project_main åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
[SUCCESS] âœ… Python è™šæ‹Ÿç¯å¢ƒåˆ›å»ºæˆåŠŸ
[INFO] å‘ç°ä¾èµ–æ–‡ä»¶: /ql/data/repo/project_main/requirements.txt
[SUCCESS] âœ… ä¾èµ–å®‰è£…æˆåŠŸ

è™šæ‹Ÿç¯å¢ƒè‡ªåŠ¨åˆ›å»ºå®Œæˆ
```

### 7.2 ç”¨æˆ·æ“ä½œæµç¨‹

#### 7.2.1 æ–°é¡¹ç›®æ¥å…¥
1. **å‡†å¤‡é¡¹ç›®**ï¼šç¡®ä¿é¡¹ç›®åŒ…å« `requirements.txt` æˆ– `package.json`
2. **æ·»åŠ è®¢é˜…**ï¼šåœ¨é’é¾™é¢æ¿æ·»åŠ  Git ä»“åº“è®¢é˜…
3. **è‡ªåŠ¨å¤„ç†**ï¼šç³»ç»Ÿè‡ªåŠ¨æ£€æµ‹å¹¶åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
4. **éªŒè¯ç»“æœ**ï¼šæŸ¥çœ‹è®¢é˜…æ—¥å¿—ç¡®è®¤è™šæ‹Ÿç¯å¢ƒåˆ›å»ºæˆåŠŸ

#### 7.2.2 ç°æœ‰é¡¹ç›®è¿ç§»
1. **æ‰‹åŠ¨åˆ›å»º**ï¼šä½¿ç”¨ `python3 /ql/scripts/qinglong_venv_manager.py create <é¡¹ç›®å>` 
2. **æˆ–é‡æ–°æ‰§è¡Œè®¢é˜…**ï¼šé‡æ–°è¿è¡Œ `ql repo` å‘½ä»¤ï¼Œè‡ªåŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
3. **éªŒè¯æ¿€æ´»**ï¼šè¿è¡Œè„šæœ¬ï¼ŒæŸ¥çœ‹æ˜¯å¦ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ

### 7.3 ç®¡ç†æ“ä½œ

#### 7.3.1 æŸ¥çœ‹è™šæ‹Ÿç¯å¢ƒçŠ¶æ€
```bash
# åˆ—å‡ºæ‰€æœ‰è™šæ‹Ÿç¯å¢ƒ
python3 /ql/scripts/qinglong_venv_manager.py list

# æŸ¥çœ‹ç‰¹å®šé¡¹ç›®ä¿¡æ¯
python3 /ql/scripts/qinglong_venv_manager.py info <é¡¹ç›®å>
```

#### 7.3.2 æ‰‹åŠ¨ç®¡ç†è™šæ‹Ÿç¯å¢ƒ
```bash
# æ‰‹åŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 /ql/scripts/qinglong_venv_manager.py create <é¡¹ç›®å>

# å¼ºåˆ¶é‡å»ºè™šæ‹Ÿç¯å¢ƒ
python3 /ql/scripts/qinglong_venv_manager.py create <é¡¹ç›®å> --force

# åˆ é™¤è™šæ‹Ÿç¯å¢ƒ
python3 /ql/scripts/qinglong_venv_manager.py remove <é¡¹ç›®å>

# è·å–æ¿€æ´»å‘½ä»¤
python3 /ql/scripts/qinglong_venv_manager.py activate <é¡¹ç›®å>
```

---

## 8. æ•…éšœæ’é™¤

### 8.1 å¸¸è§é—®é¢˜

#### 8.1.1 è™šæ‹Ÿç¯å¢ƒæœªæ¿€æ´»

**ç—‡çŠ¶ï¼š** è„šæœ¬è¿è¡Œæ—¶æç¤º `ModuleNotFoundError`

**æ’æŸ¥æ­¥éª¤ï¼š**
```bash
# 1. æ£€æŸ¥è¡¥ä¸çŠ¶æ€
bash sitecustomize-venv-patch.sh status

# 2. æ£€æŸ¥è™šæ‹Ÿç¯å¢ƒæ˜¯å¦å­˜åœ¨
ls -la /ql/data/scripts/<é¡¹ç›®å>/.venv/

# 3. æ£€æŸ¥è„šæœ¬æ‰§è¡Œæ—¥å¿—
tail -f /ql/data/log/<é¡¹ç›®å>/*.log
```

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# é‡æ–°åº”ç”¨ sitecustomize è¡¥ä¸
bash qinglong_venv_installer.sh repair

# æ‰‹åŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 /ql/scripts/qinglong_venv_manager.py create <é¡¹ç›®å>
```

#### 8.1.2 è™šæ‹Ÿç¯å¢ƒæœªè‡ªåŠ¨åˆ›å»º

**ç—‡çŠ¶ï¼š** è®¢é˜…æ›´æ–°åæ²¡æœ‰åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ

**æ’æŸ¥æ­¥éª¤ï¼š**
```bash
# 1. æ£€æŸ¥ Shell è„šæœ¬è¡¥ä¸
bash qinglong_venv_installer.sh status

# 2. æ£€æŸ¥é¡¹ç›®æ˜¯å¦æœ‰ä¾èµ–æ–‡ä»¶
ls -la /ql/data/repo/<é¡¹ç›®å>/requirements.txt
ls -la /ql/data/repo/<é¡¹ç›®å>/package.json

# 3. æŸ¥çœ‹è®¢é˜…æ‰§è¡Œæ—¥å¿—
grep -A 10 "è‡ªåŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ" /ql/data/log/<é¡¹ç›®å>/*.log
```

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# é‡æ–°åº”ç”¨ç³»ç»Ÿè¡¥ä¸
bash qinglong_venv_installer.sh repair

# æ‰‹åŠ¨è§¦å‘è™šæ‹Ÿç¯å¢ƒåˆ›å»º
python3 /ql/scripts/qinglong_venv_manager.py create <é¡¹ç›®å>

# é‡æ–°æ‰§è¡Œè®¢é˜…
ql repo <ä»“åº“åœ°å€> "" "" "requirements.txt" "main" "py"
```

#### 8.1.3 ä¾èµ–å®‰è£…å¤±è´¥

**ç—‡çŠ¶ï¼š** è™šæ‹Ÿç¯å¢ƒåˆ›å»ºæˆåŠŸä½†ä¾èµ–å®‰è£…å¤±è´¥

**æ’æŸ¥æ­¥éª¤ï¼š**
```bash
# 1. æ£€æŸ¥ç½‘ç»œè¿æ¥
ping pypi.tuna.tsinghua.edu.cn

# 2. æ‰‹åŠ¨å®‰è£…ä¾èµ–
cd /ql/data/scripts/<é¡¹ç›®å>
source .venv/bin/activate
pip install -r requirements.txt

# 3. æ£€æŸ¥ä¾èµ–æ–‡ä»¶æ ¼å¼
cat requirements.txt
```

### 8.2 æ—¥å¿—åˆ†æ

#### 8.2.1 å…³é”®æ—¥å¿—ä½ç½®
- **è®¢é˜…æ‰§è¡Œæ—¥å¿—**ï¼š`/ql/data/log/<è®¢é˜…å>/`
- **è™šæ‹Ÿç¯å¢ƒæ—¥å¿—**ï¼šè„šæœ¬æ‰§è¡Œè¾“å‡ºä¸­çš„ `[VENV_AUTO]` æ ‡è®°
- **é’é¾™ç³»ç»Ÿæ—¥å¿—**ï¼š`pm2 logs qinglong`

#### 8.2.2 æ—¥å¿—å…³é”®å­—
```bash
# è™šæ‹Ÿç¯å¢ƒæ¿€æ´»æˆåŠŸ
grep "VENV_AUTO.*å·²æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ" /ql/data/log/<é¡¹ç›®å>/*.log

# è™šæ‹Ÿç¯å¢ƒåˆ›å»ºæˆåŠŸ  
grep "AUTO_VENV.*åˆ›å»ºå®Œæˆ" /ql/data/log/<é¡¹ç›®å>/*.log

# ä¾èµ–å®‰è£…çŠ¶æ€
grep -E "(ä¾èµ–å®‰è£…|install)" /ql/data/log/<é¡¹ç›®å>/*.log
```

### 8.3 æ¢å¤æ“ä½œ

#### 8.3.1 æ¢å¤è¡¥ä¸
```bash
# æ¢å¤æ‰€æœ‰è¡¥ä¸åˆ°åŸå§‹çŠ¶æ€
bash qinglong_venv_installer.sh uninstall
```

#### 8.3.2 æ¸…ç†è™šæ‹Ÿç¯å¢ƒ
```bash
# åˆ é™¤æ‰€æœ‰è™šæ‹Ÿç¯å¢ƒ
find /ql/data/scripts -name ".venv" -type d -exec rm -rf {} +

# åˆ é™¤ Node.js ç¯å¢ƒ
find /ql/data/scripts -name "node_modules" -type d -exec rm -rf {} +
```

---

## 9. æœ€ä½³å®è·µ

### 9.1 é¡¹ç›®ç»“æ„å»ºè®®

#### 9.1.1 Python é¡¹ç›®
```
é¡¹ç›®æ ¹ç›®å½•/
â”œâ”€â”€ requirements.txt          # å¿…éœ€ï¼šé¡¹ç›®ä¾èµ–
â”œâ”€â”€ src/                     # æ¨èï¼šæºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ main.py             # ä¸»è„šæœ¬
â”‚   â””â”€â”€ utils/              # å·¥å…·æ¨¡å—
â”œâ”€â”€ config/                  # å¯é€‰ï¼šé…ç½®æ–‡ä»¶
â””â”€â”€ README.md               # æ¨èï¼šé¡¹ç›®è¯´æ˜
```

#### 9.1.2 Node.js é¡¹ç›®
```
é¡¹ç›®æ ¹ç›®å½•/
â”œâ”€â”€ package.json            # å¿…éœ€ï¼šé¡¹ç›®ä¾èµ–å’Œé…ç½®
â”œâ”€â”€ src/                    # æ¨èï¼šæºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ index.js           # ä¸»è„šæœ¬
â”‚   â””â”€â”€ lib/               # åº“æ–‡ä»¶
â”œâ”€â”€ config/                 # å¯é€‰ï¼šé…ç½®æ–‡ä»¶
â””â”€â”€ README.md              # æ¨èï¼šé¡¹ç›®è¯´æ˜
```

### 9.2 ä¾èµ–ç®¡ç†å»ºè®®

#### 9.2.1 requirements.txt æœ€ä½³å®è·µ
```txt
# å›ºå®šç‰ˆæœ¬å·ï¼Œç¡®ä¿ç¯å¢ƒä¸€è‡´æ€§
requests==2.31.0
pandas==2.0.3

# ä½¿ç”¨å…¼å®¹ç‰ˆæœ¬èŒƒå›´
numpy>=1.24.0,<2.0.0

# æ·»åŠ æ³¨é‡Šè¯´æ˜ç”¨é€”
beautifulsoup4==4.12.2  # HTML è§£æ
lxml==4.9.3             # XML å¤„ç†

# åˆ†ç»„ç®¡ç†ä¾èµ–
# æ ¸å¿ƒä¾èµ–
flask==2.3.3
sqlalchemy==2.0.21

# å¼€å‘ä¾èµ–ï¼ˆå¯é€‰ï¼‰
# pytest==7.4.2
# black==23.7.0
```

#### 9.2.2 package.json æœ€ä½³å®è·µ
```json
{
  "name": "qinglong-project",
  "version": "1.0.0",
  "description": "é’é¾™é¡¹ç›®æè¿°",
  "main": "src/index.js",
  "dependencies": {
    "axios": "^1.5.0",
    "lodash": "^4.17.21"
  },
  "devDependencies": {
    "eslint": "^8.48.0"
  },
  "engines": {
    "node": ">=14.0.0"
  }
}
```

### 9.3 æ€§èƒ½ä¼˜åŒ–å»ºè®®

#### 9.3.1 ä¾èµ–ä¼˜åŒ–
- **æœ€å°åŒ–ä¾èµ–**ï¼šåªå®‰è£…å¿…éœ€çš„åŒ…
- **ç‰ˆæœ¬é”å®š**ï¼šä½¿ç”¨å…·ä½“ç‰ˆæœ¬å·é¿å…æ„å¤–æ›´æ–°
- **å®šæœŸæ¸…ç†**ï¼šåˆ é™¤ä¸å†ä½¿ç”¨çš„ä¾èµ–

#### 9.3.2 è™šæ‹Ÿç¯å¢ƒä¼˜åŒ–
- **å®šæœŸé‡å»º**ï¼šå½“ä¾èµ–å˜åŒ–è¾ƒå¤§æ—¶é‡å»ºè™šæ‹Ÿç¯å¢ƒ
- **ç£ç›˜æ¸…ç†**ï¼šå®šæœŸæ¸…ç†ä¸å†ä½¿ç”¨çš„è™šæ‹Ÿç¯å¢ƒ
- **ç¼“å­˜åˆ©ç”¨**ï¼šåˆ©ç”¨ pip ç¼“å­˜åŠ é€Ÿå®‰è£…

### 9.4 å®‰å…¨å»ºè®®

#### 9.4.1 ä¾èµ–å®‰å…¨
- **æ¥æºå¯ä¿¡**ï¼šä½¿ç”¨å®˜æ–¹ PyPI å’Œ npm ä»“åº“
- **ç‰ˆæœ¬å®¡æŸ¥**ï¼šå®šæœŸæ£€æŸ¥ä¾èµ–çš„å®‰å…¨æ¼æ´
- **æœ€å°æƒé™**ï¼šé¿å…ä½¿ç”¨å…·æœ‰è¿‡é«˜æƒé™çš„åŒ…

#### 9.4.2 ç¯å¢ƒéš”ç¦»
- **ä¸¥æ ¼éš”ç¦»**ï¼šç¡®ä¿é¡¹ç›®é—´çš„å®Œå…¨éš”ç¦»
- **æƒé™æ§åˆ¶**ï¼šåˆç†è®¾ç½®æ–‡ä»¶å’Œç›®å½•æƒé™
- **å®šæœŸå¤‡ä»½**ï¼šå¤‡ä»½é‡è¦çš„è™šæ‹Ÿç¯å¢ƒé…ç½®

---

## 10. æ€»ç»“

### 10.1 æ–¹æ¡ˆä»·å€¼

æœ¬è§£å†³æ–¹æ¡ˆé€šè¿‡**åŒé‡è‡ªåŠ¨åŒ–æœºåˆ¶**ï¼Œå½»åº•è§£å†³äº†é’é¾™é¢æ¿çš„è™šæ‹Ÿç¯å¢ƒç®¡ç†é—®é¢˜ï¼š

1. **åˆ›å»ºè‡ªåŠ¨åŒ–**ï¼šé€šè¿‡ Shell è„šæœ¬è¡¥ä¸ï¼Œåœ¨è®¢é˜…æ›´æ–°æ—¶è‡ªåŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
2. **æ¿€æ´»è‡ªåŠ¨åŒ–**ï¼šé€šè¿‡ sitecustomize.py è¡¥ä¸ï¼Œè„šæœ¬æ‰§è¡Œæ—¶è‡ªåŠ¨æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
3. **ç®¡ç†è‡ªåŠ¨åŒ–**ï¼šæä¾›å®Œæ•´çš„å‘½ä»¤è¡Œç®¡ç†å·¥å…·é“¾

### 10.1.1 ç»è¿‡éªŒè¯çš„æœ€ç»ˆæ–¹æ¡ˆ

ç»è¿‡å®é™…æµ‹è¯•éªŒè¯ï¼Œæˆ‘ä»¬ç¡®è®¤äº†ä»¥ä¸‹**å¯è¡Œçš„æŠ€æœ¯æ–¹æ¡ˆ**ï¼š

#### âœ… **Shell è„šæœ¬è¡¥ä¸æ–¹æ¡ˆ** (å·²éªŒè¯å¯è¡Œ)
- **åŸç†**ï¼šç›´æ¥ä¿®æ”¹ `/ql/shell/update.sh` ä¸­çš„ `update_repo` å‡½æ•°
- **ä¼˜ç‚¹**ï¼šç®€å•ç›´æ¥ï¼Œç«‹å³ç”Ÿæ•ˆï¼Œæ— éœ€é‡å¯é’é¾™æœåŠ¡
- **å®ç°**ï¼šä½¿ç”¨ `shell_patch_installer.sh` ä¸€é”®å®‰è£…

#### âœ… **sitecustomize.py è¡¥ä¸æ–¹æ¡ˆ** (å·²éªŒè¯å¯è¡Œ)
- **åŸç†**ï¼šä¿®æ”¹ Python å¯åŠ¨è„šæœ¬ï¼Œè‡ªåŠ¨æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
- **ä¼˜ç‚¹**ï¼šå¯¹æ‰€æœ‰ Python è„šæœ¬é€æ˜ç”Ÿæ•ˆ
- **å®ç°**ï¼šä½¿ç”¨ `qinglong_venv_installer.sh` å®‰è£…

#### âŒ **è®¢é˜…æœåŠ¡è¡¥ä¸æ–¹æ¡ˆ** (éªŒè¯å¤±è´¥)
- **é—®é¢˜**ï¼šé’é¾™å¯èƒ½ä½¿ç”¨ç¼–è¯‘åçš„ JavaScriptï¼ŒTypeScript ä¿®æ”¹ä¸ç”Ÿæ•ˆ
- **æ›¿ä»£**ï¼šä½¿ç”¨ Shell è„šæœ¬è¡¥ä¸æˆ– Web ç•Œé¢é…ç½®

### 10.2 æ¨èå®‰è£…æ–¹æ¡ˆ

#### ğŸ¥‡ **æ–¹æ¡ˆ Aï¼šå®Œæ•´å®‰è£… (æ¨è)**
```bash
# ä¸€é”®å®‰è£…å®Œæ•´ç³»ç»Ÿ (åŒ…å« sitecustomize.py è¡¥ä¸å’Œ Shell è„šæœ¬è¡¥ä¸)
bash qinglong_venv_installer.sh install

# éªŒè¯å®‰è£…
bash qinglong_venv_installer.sh status
```

#### ğŸ¥ˆ **æ–¹æ¡ˆ Bï¼šWeb ç•Œé¢é…ç½®**
åœ¨é’é¾™ Web ç•Œé¢çš„è®¢é˜…é…ç½®ä¸­ï¼Œ"è®¢é˜…åæ‰§è¡Œ" å­—æ®µæ·»åŠ ï¼š
```bash
python3 /ql/scripts/qinglong_venv_manager.py create $(basename $(pwd))
```

#### ğŸ¥‰ **æ–¹æ¡ˆ Cï¼šæ‰‹åŠ¨ç®¡ç†**
```bash
# æ‰‹åŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 /ql/scripts/qinglong_venv_manager.py create <é¡¹ç›®å>
```

### 10.3 æŠ€æœ¯åˆ›æ–°

- **ğŸ¯ å®ç”¨ä¸»ä¹‰è®¾è®¡**ï¼šé€‰æ‹©æœ€å¯è¡Œçš„æŠ€æœ¯è·¯å¾„
- **ğŸ”§ æ™ºèƒ½æ£€æµ‹æœºåˆ¶**ï¼šå¤šç­–ç•¥é¡¹ç›®è¯†åˆ«
- **âš¡ é›¶é…ç½®ç†å¿µ**ï¼šå¼€ç®±å³ç”¨çš„ç”¨æˆ·ä½“éªŒ
- **ğŸ›¡ï¸ å®Œæ•´å¤‡ä»½æ¢å¤**ï¼šå®‰å…¨å¯é çš„å‡çº§è·¯å¾„

### 10.4 é€‚ç”¨åœºæ™¯

- âœ… **å¤šé¡¹ç›®ç¯å¢ƒ**ï¼šéœ€è¦ç®¡ç†å¤šä¸ª Python/Node.js é¡¹ç›®
- âœ… **ä¾èµ–å†²çª**ï¼šä¸åŒé¡¹ç›®æœ‰ä¾èµ–ç‰ˆæœ¬å†²çª
- âœ… **è‡ªåŠ¨åŒ–éœ€æ±‚**ï¼šå¸Œæœ›å‡å°‘æ‰‹åŠ¨ç»´æŠ¤å·¥ä½œ
- âœ… **å›¢é˜Ÿåä½œ**ï¼šéœ€è¦ç»Ÿä¸€çš„ç¯å¢ƒç®¡ç†æ–¹æ¡ˆ

### 10.5 å®é™…éªŒè¯ç»“æœ

é€šè¿‡ä¸ç”¨æˆ·çš„å®é™…æµ‹è¯•ï¼Œæˆ‘ä»¬éªŒè¯äº†ä»¥ä¸‹å…³é”®åŠŸèƒ½ï¼š

#### âœ… **Shell è„šæœ¬è¡¥ä¸**
- **æµ‹è¯•å‘½ä»¤**ï¼š`ql repo "https://git.example.com/project.git" "" "" "requirements.txt" "main" "py"`
- **éªŒè¯ç»“æœ**ï¼šæˆåŠŸåœ¨è®¢é˜…æ›´æ–°åè‡ªåŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
- **æ—¥å¿—è¾“å‡º**ï¼šæ˜¾ç¤º "## è‡ªåŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ..." å’Œåˆ›å»ºæˆåŠŸä¿¡æ¯

#### âœ… **è™šæ‹Ÿç¯å¢ƒç®¡ç†å™¨**
- **æµ‹è¯•å‘½ä»¤**ï¼š`python3 /ql/scripts/qinglong_venv_manager.py create project_name`
- **éªŒè¯ç»“æœ**ï¼šæˆåŠŸåˆ›å»º Python è™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…ä¾èµ–
- **åŠŸèƒ½ç¡®è®¤**ï¼šlistã€infoã€removeã€activate ç­‰å‘½ä»¤å‡æ­£å¸¸å·¥ä½œ

#### âœ… **sitecustomize.py è¡¥ä¸**
- **æµ‹è¯•åœºæ™¯**ï¼šPython è„šæœ¬æ‰§è¡Œæ—¶è‡ªåŠ¨æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
- **éªŒè¯ç»“æœ**ï¼šè„šæœ¬èƒ½å¤Ÿæ­£ç¡®å¯¼å…¥è™šæ‹Ÿç¯å¢ƒä¸­çš„ä¾èµ–åŒ…
- **æ—¥å¿—è¾“å‡º**ï¼šæ˜¾ç¤º "[VENV_AUTO] âœ… å·²æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ" ä¿¡æ¯

### 10.6 æœªæ¥å±•æœ›

- **ğŸš€ æ›´å¤šè¯­è¨€æ”¯æŒ**ï¼šæ‰©å±•åˆ° Goã€Rust ç­‰è¯­è¨€
- **ğŸ“Š ç›‘æ§å¢å¼º**ï¼šæ›´è¯¦ç»†çš„ä½¿ç”¨ç»Ÿè®¡å’Œæ€§èƒ½ç›‘æ§
- **ğŸ”„ è‡ªåŠ¨æ›´æ–°**ï¼šä¾èµ–çš„è‡ªåŠ¨æ›´æ–°å’Œå®‰å…¨æ‰«æ
- **ğŸŒ äº‘ç«¯åŒæ­¥**ï¼šè™šæ‹Ÿç¯å¢ƒé…ç½®çš„äº‘ç«¯å¤‡ä»½å’ŒåŒæ­¥

### 10.7 è´¡çŒ®æŒ‡å—

æ¬¢è¿ç¤¾åŒºè´¡çŒ®ï¼š
- **ğŸ› é—®é¢˜åé¦ˆ**ï¼šé€šè¿‡ Issue æŠ¥å‘Šé—®é¢˜
- **ğŸ’¡ åŠŸèƒ½å»ºè®®**ï¼šæå‡ºæ–°åŠŸèƒ½éœ€æ±‚
- **ğŸ”§ ä»£ç è´¡çŒ®**ï¼šæäº¤ Pull Request
- **ğŸ“– æ–‡æ¡£å®Œå–„**ï¼šæ”¹è¿›æ–‡æ¡£å’Œç¤ºä¾‹

---

## ğŸ“ è”ç³»æ–¹å¼

- **é¡¹ç›®åœ°å€**ï¼š[GitHub Repository]
- **é—®é¢˜åé¦ˆ**ï¼š[Issues]
- **è®¨è®ºäº¤æµ**ï¼š[Discussions]

---

**ğŸ‰ æ„Ÿè°¢ä½¿ç”¨é’é¾™è™šæ‹Ÿç¯å¢ƒç®¡ç†è§£å†³æ–¹æ¡ˆï¼**

*è®©è™šæ‹Ÿç¯å¢ƒç®¡ç†å˜å¾—ç®€å•ã€è‡ªåŠ¨ã€å¯é ï¼*
